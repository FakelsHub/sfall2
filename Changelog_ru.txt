
Список изменений:

v1.7.28
! Исправлен функционал переменной ExtraSaveSlots.
* Подправлен функционал переменной PipBoyAvailableAtGameStart.
+ Добавлена переменная NumbersInDialogue для показа номеров выбора вместо точек в диалоговом окне.
- Удалена переменная AllowUnsafeScripting, а все "небезопасные" функции теперь доступны (но их правильное использовании на совести используемого) и в релизном варианте dll.
! Исправлены функции get_screen_width и get_screen_height.
* Название переменной InstanWeaponEquip исправлено на InstantWeaponEquip (как изначально и должно было быть).
* Переписаны ExtraSaveSlots и EnableHeroAppearanceMod.
! Исправлен мой баг с неправильным изменением статов ГГ при смене брони в wield_obj_critter (обрабатывалась старая "одетая" броня, которая к этому моменту уже была снята в обработчике hs_invenwield).
! Исправлен баг заcтывания убитых персонажей при использовании kill_critter_type.
! Добавлены проверки для предотвращения крашей при использовании скриптов с ошибками (одевание чего-либо без наличия этого чего-либо в инвентаре).
* Улучшено и исправлено управление персонажами в бою - персонаж временно получает перки "Свежевание гекко" и "Наблюдательность" (конечно если они есть у ГГ), исправлено слетание брони при использовании ArmorFile или скриптового мода, вместо индикатора скрытности показывается имя персонажа, при убийстве врагов правильно считается карма, а опыт в бою (к примеру, за квест) получает только ГГ.
! Исправлена проверка позиции по оси y вместо x при задании координат на мировой карте (функция wm_area_set_pos).
+ Если у оружия есть несколько вариантов звукового эффекта для конкретного действия, то теперь при воспроизведении эффект выбирается случайным образом.
* В hs_barterprice добавлены 3 аргумента.
! В FreeWeight исправлено неправильное визуальное изменение количества предметов на "столах" обмена.
+ Добавлены вызовы скриптовых процедур combat_is_starting_p_proc (начало боя - вызывается при инициализации данных, но не означает что персонаж находится в бою) и combat_is_over_p_proc (завершение боя).
! Исправлено использование фиксированной позиции для вызова скриптовой процедуры start при отсутствии стандартного обработчика.
! Исправлено использование gdialog_mod_barter с персонажами без установленного флага торговли.
! Для Fallout:Nevada (определяется по размеру файла) отключена обработка GVAR 491 (GVAR_SHAIEN_RADIOSTANC_KNOW = GVAR_MODOC_SHITTY_DEATH) при смерти ГГ, что вызывало краш.
* Теперь функция sfall_ver_build всегда возвращает 509 (используется для определения что это sfall2).
- Из ddraw.ini удалена переменная BodyHit_Uncalled и должным образом подправлены функции get/set_bodypart_hit_modifier.
- Из ddraw.ini удалена переменная NumberPatchLoop (теперь эффект включения постоянный с лимитом 1000), а также изменён алгоритм создания цепочки каталогов/dat-файлов, что позволяет полноценно использовать patch###.dat.
+ Добавлена переменная CanSeeAndHearFix для включения дополнительных проверок на слепоту и прямую видимость в движковой функции is_within_perception_.
* Теперь эффект TurnHighlightContainers действует и на мёртвых персонажей.
+ В секцию [Speed] добавлена переменная TimeScale для изменения (увеличения) скорости течения времени в игре.
+ Добавлена переменная UsePartySkills - при использовании умений (первая помощь, доктор, взлом, ловушки, наука или ремонт) всегда использовать сопартийца с наивысшим уровнем умения (которое не обязательно должно быть самым высоким из всех умений этого сопартийца).
! Исправлен "print to file" баг, а также восстановлена возможность использования файлов с длинными именами.
* Глобальные и хуковые скрипты теперь могут быть упакованы в dat-файл.

v1.7
- Из ddraw.ini удалена переменная GainStatPerkFix (теперь эффект включения постоянный).
* Теперь FreeWeight показывает "свободный вес у владельца-персонажа/свободный размер сумки" для открытых вложенных сумок.
! Исправлено несколько недоработок связанных с кнопками "Взять всё"/"Положить всё" (и вложенными сумками).
! Исправлено пропадание предметов в инвентаре при попытке поместить их во вложенную сумку если игрок перегружен.
+ На экране снаряжения игрока показывается "свободный вес у владельца-персонажа/свободный размер сумки" в открытой вложенной сумке.
* Подправлен hs_inventorymove и добавлена обработка события при перетаскивании предмета во вложенную сумку.
! Исправлены используемые движком функции получения одетой брони и оружия в руках игрока если в инвентаре открыта вложенная сумка.
* Теперь hs_keypress может возвращать сканкод новой клавиши, которая будет обработана движком вместо оригинальной.
! Исправлен вывод в окно монитора сообщения при попадании в случайную цель если она не является персонажем и у неё есть скрипт, а также вызов damage_p_proc при промахах если цель не_персонаж.
! Исправлен краш при клике по пустому месту в инвентаре при курсорном использовании предмета из основного рюкзака.
! Исправлен мой баг в обработчике расчёта статов при использовании переменной DerivedStats.
- Удалена обработка переменной ModifiedIni из ddraw.ini, а функция modified_ini возвращает фальшивое значение (в качестве альтернативы можно использовать функцию get_ini_setting).
* При UseScrollWheel=1 можно прокручивать окно монитора (хоть и не так эффективно как это делает HRP).
! Исправлено использование вложенных сумок в окне торговли.
! Исправлен краш при попытке открыть сумку/рюкзак в окне торговли.
+ Добавлено изменение из sfall:
  >Fixed potential undefined behavior and crashes in sfall arrays (From Vennor)
! Исправлена неправильная инициализация очков действия в начале каждого хода, что приводило к добавлению скрытого бонуса к классу брони у противников и из-за этого уменьшался шанс попадания по ним.

v1.6
+ Добавлены режимы возвращаемые функцией get_game_mode: INTFACEUSE (открыто окно инвентаря при курсорном использовании предмета из рюкзака), INTFACELOOT (открыто окно обшаривания ящиков/трупиков) и BARTER (открыто окно торговли).
* Исправлен функционал hs_ammocost и CheckWeaponAmmoCost - теперь они функционируют независимо друг от друга.
+ Добавлена переменная CarryWeightLimit для изменения лимита веса.
* Переписан, исправлен и доведён до ума CritterInvSizeLimitMode - теперь это полностью функциональное и интересное расширение. Значение переменной CritterInvSizeLimit применяется ко всем персонажам и для его хранения используется STAT_unused этого персонажа, что позволяет изменять значение с помощью set_critter_stat. На экране снаряжения игрока, а также в окне настроек сопартийца в поле "Несёт" кроме "общий вес/максимальный вес" показывается (при соответствующем режиме) дополнительно "общий размер/максимальный размер".
* Теперь FreeWeight поддерживает любой режим CritterInvSizeLimitMode, но чтобы не возникла путаница пришлось изменить формат отображения отказавшись от показа максимального значения. Сейчас формат - "свободный вес" для персонажей и "свободный размер" для контейнеров, а при включённом режиме CritterInvSizeLimitMode для заданных персонажей - "свободный вес/свободный размер".
* Исправлен hs_invenwield.
+ Добавлена переменная CarChargingFix для изменения возможности зарядки автомобиля с помощью использования топливных элементов на других объектах.
* Доработано исправление бага "форсированного использования взрывчатки если взрыв задевает кого-либо рядом, возврата на карту и снова выхода с карты".
+ Исправлено неправильное определение пути при чтении/записи файлов sfallgv.sav и sfallfs.sav.
! Исправлен obj_can_hear_obj и чутка подправлен obj_can_see_obj.
* Теперь при включённой переменной UseScrollWheel можно прокручивать инвентарь цели в окне обшаривания ящиков/трупиков или окне торговли.

v1.5
* Переписан оригинальный explosion_crash_fix на "правильный" вариант :-p
! Исправлен приводящий к крашу баг с форсированным (подбросить взрывчатку и покинуть карту до взрыва) использованием взрывчатки если взрыв задевает кого-либо рядом, возвратом на карту и снова выходом с карты.
! Теперь при форсированном использовании взрывчатки и смерти жертвы вызывается destroy_p_proc.
* Значение переменной SpeedInterfaceCounterAnims может быть равно 2 - в этом случае значение счётчиков будет изменяться мгновенно.
+ Добавлена переменная InstanWeaponEquip, включение которой отключает анимацию убирания/доставания оружия при его смене, открытии ящиков и т.д..
* Вместо переменных BodypartHitMod0...BodypartHitMod8 используются BodyHit_Head...BodyHit_Uncalled как в sfall1.
* Переписан оригинальный TimeLimit с исправлениями (потерянное время, обработка очереди событий). Удалено значение -2 (переполнение счётчика и зависание игры. Какая от него польза?). Если всё же -2 используется, то эффект такой же как если бы указали -3. Правильно отображается возраст игрока (впрочем он ограничен 99, чтобы не портить вывод) на экране персонажа.
+ Добавлена переменная PipboyTimeAnimDelay для изменения скорости анимации времени в будильнике пипбоя.
+ Добавлены изменения из sfall:
  >Fixed incorrect bonuses on AC and Melee Damage from Heavy Handed trait when using perks.ini
  >A new hook script: hs_invenwield (when wielding or unwielding an armor or a weapon by a critter)
  >Expanded message_str_game function to support all pro_*.msg files as well
  >Removed obsolete Jim's damage formula
- Удалена устаревшая переменная WorldMapFPS и связанная с ней ForceLowResolutionTimer (обрабатывались только если WorldMapFPSPatch=0), а также WorldMapDelay (обрабатывалась только если WorldMapFPS и WorldMapFPSPatch равны 0).
* Теперь WorldMapEncounterFix обрабатывается независимо от значения WorldMapFPSPatch (ранее только если WorldMapFPSPatch=0).
! Исправлено отображение полученного дамага при мгновенной смерти.
* Из ddraw.ini удалена переменная MultiHexPathingFix, причина аналогична удалению BlackSkilldexFix.
* Оптимизирован AnimationsAtOnceLimit, в результате чего dll'ка похудела на 10 Kb ;)
! Исправлен функционал переменной OverrideMusicDir.
* Теперь при включённой переменной CheckWeaponAmmoCost проверяется ещё и количество патронов у оружия при стрельбе очередью.

v1.4
* Из ddraw.ini удалена переменная WieldObjCritterFix, причина аналогична удалению BlackSkilldexFix.
* Добавлена переменная CanSellUsedGeiger для контроля возможности продажи "Счетчик Гейгера"/"Невидимка" после использования.
! Исправлен вывод в окне монитора количества полученных очков опыта с учётом бонуса от взятого перка 'Прилежный ученик' после убийства врагов/воровства/случайных встреч на карте.
! Исправлен баг "NPC turns into a container".

v1.3
+ В секцию [Debugging] добавлена переменная NoCredits, её включение отключает отображение встроенных благодарностей.
! Теперь можно продать "Счетчик Гейгера"/"Невидимка" после использования.

v1.2
* Из ddraw.ini удалены переменные BlackSkilldexFix, JetAntidoteFix, SpecialUnarmedAttacksFix и DodgyDoorsFix - это чистые багфиксы, их постоянное включение не вызывает побочных эффектов, а потому наличие переменных в ini-файле бессмысленно.
* В Elevators.ini добавлена секция [Frms] с переменными Image0..Image23 с помощью которых можно переопределить номер используемой картинки (frm) для лифта.
+ Исправлен баг использования топливных элементов при зарядке полностью заряженной машины.

v1.1
! Исправлен баг отображения отрицательных значений (будет показываться 0) в окне навыков.
+ Если взят перк 'Бонус урона на расст.' то в инвентаре будет показываться изменение мин./макс. дамага для оружия в руках.
* Исправлен оригинальный BonusHtHDamageFix чтобы в инвентаре и экране персонажа показывались изменения минимального (если BonusHtHDamageFix=1) и максимального дамага холодного оружия/без оружия при взятом перке 'Бонус рукопашного урона'.

01/07/15
* Переменную DebugMode теперь можно использовать не только с отладочным, но и с релизным вариантом dll.
* Для переменной ExtraCRC теперь можно через запятую указать несколько вариантов crc.
! Исправлен "Unlimited Ammo bug".

28/06/15
! Исправлен баг из-за которого невозможно использовать 9 строку в диалоговом варианте выбора ответов.

27/06/15
! Исправлен баг неправильных статов у сопартийца если в момент получения уровня он находился под наркотическими эффектами.
! Если в инвентаре сопартийца есть броня такая же как на нём одета, то при получении уровня он теряет класс брони равный значению получаемому от этой брони. Исправлено.
+ При случайных встречах после загрузки карты в окне монитора вместо двух строчек для описания встречи будет использоваться одна.

26/06/15
+ Теперь можно использовать управляющий символ перевода строки (\n) в описаниях объектов из pro_*.msg файлов.

25/06/15
! Исправлен баг вызывающий краш игры если попытаться убить любого персонажа накачав его суперстимуляторами и покинув карту.

24/06/15
* Доработан контроль (ControlCombat) сопартийцев или всех персонажей в бою - трейты/перки игрока не распространяются на контролируемых персонажей. Для контролируемых персонажей нельзя одеть броню в инвентаре и нельзя сохраняться, а нажатие Enter (завершение боя) распознаётся как Space (окончание хода). Также нельзя включать умение "Скрытность".
! Исправлен баг прокачивания статов через двойное принятие одного наркотика, записи игры с последующей загрузкой и повторного двойного принятия того же наркотика.

20/06/15
! Исправлен баг проверки зависимости у любых персонажей (ранее всегда использовались данные игрока).
! Исправлен баг с использованием винта сопартийцами и невозможностью использовать противоядие для их лечения.
+ В окне настроек сопартийца в поле "Здоровье" изменяется цвет строки с зелёного на красный когда у сопартийца есть зависимость.

10/06/15
* Для текущего уровня и класса брони показываемых в окне настроек сопартийца в полях "Здоровье" и "ОД" добавлены сокращения названий ("Ур." и "КБ")

02/06/15
* Для исправленого бага зарядки машины добавлена проверка на багажник помимо проверки на саму машину.

01/06/15
! Исправлен баг с зарядкой машины используя топливные элементы на любых объектах.

30/05/15
+ Добавлена переменная DontTurnOffSneakIfYouRun. Если она включена, то при включённом режиме бега если не взят перк 'Бесшумный бег' не будет отключаться умение "Скрытность" - вместо этого персонаж будет ходить.

29/05/15
+ Добавлена переменная AutoQuickSave для использования больше одного слота при быстром сохранении (F6) и без предварительного выбора самого слота. Значение определяет количество используемых слотов (1..10) - отсчёт с первого слота, циклический перебор, перезаписывается самая ранняя игра.

25/05/15
* Исправлен оригинальный SpeedInterfaceCounterAnims в момент смерти (отрицательные значения), когда, к примеру, показывалось "-993" вместо "-007".
+ Добавлена переменная EnableMusicInDialogue с помощью которой можно включить проигрывание музыки при общении с говорящими бошками, эффект такой же как и с неговорящими бошками - громкость музыки уменьшается в два раза.

16/05/15
+ Добавлена переменная DisableHotkeysForUnknownAreasInCity - отключает использование "горячих" клавиш для перехода по неоткрытым зонам при выборе зоны на карте города.

11/05/15
+ Изменена дистанция перехода на шаг с 5 на 1 когда нужно использовать на объекте что-то, подобрать, обчистить или использовать на нём скилл.
+ Добавлена переменная FakeCombatFix для исправления читеринга с кнопкой "A" - можно подбирать вещи, открывать контейнеры и использовать что-то на ком-то если цель рядом. После агрессивного действия (выстрел/удар/etc) можно передвигаться.

10/05/15
+ Добавлена переменная TurnHighlightContainers в секцию [Input] - включает/выключает подсветку контейнеров при использовании ToggleItemHighlightsKey.

05/05/15
* Расширен функционал ToggleItemHighlightsKey - теперь подсвечиваются не только предметы на земле, но и контейнеры. Другим цветом. Совмещена подсветка с курсором мыши, чтобы убрать ситуацию когда сначала предмет подсвечивается курсором мыши, затем нажимается "горячая" клавиша, отпускается и пропадает подсветка того предмета, на котором курсор мыши. В связи с этим, для лучшего восприятия, изменён цвет подсветки с жёлтого на розовый при наведении мыши на предмет.
* Исправлена возможность (из-за отключённого пропадания неиспользованного перка) получения многоуровневых перков раньше: не использовать, к примеру, перк на 9 уровне и на 12 сразу взять два уровня одного перка которые в оригинале можно взять только на 12 и 15 уровнях.

02/05/15
+ Добавлена кнопка "Положить всё" при обмене с контейнером, можно использовать "горячие" клавиши 'd' и 'D'. Для отображения кнопки используется иконка мыши "Бросить предмет".
+ При обмене с контейнером для кнопки "Взять всё" помимо "горячей" клавиши 'A' можно использовать и клавишу 'a'.

22/04/15
+ Теперь, открыв инвентарь, можно перетаскивать стимпаки и прочую химию из инвентаря на картинку игрока с эффектом использования.

20/04/15
+ Переписан оригинальный SharpshooterFix на правильный вариант предложенный Slider2k с форума NMA.
* Переменная ReloadReserve может быть равна -1, в этом случае при перезарядке оружия перетаскиванием патронов на это оружие будет использоваться оригинальный способ с навязчивым окном для ввода количества пачек.

19/04/15
* Добавлена переменная ReloadReserve (дальнейшее развитие убирания навязчивого окошка с предложением указать количество коробок патронов), которая изменяет механизм перезарядки оружия перетаскиванием патронов на это оружие: 0 = использовать все имеющиеся патроны; 1 и больше = резервные пачки патронов - если имеющееся количество пачек патронов больше заданного резерва, то будут использованы все патроны за вычетом резерва, если меньше или равно резерву, то будет использована только одна пачка патронов.

18/04/15
! Исправлен баг при зарядке оружия в инвентаре - если оружие в единственном экземпляре и находится перед патронами, то используется только одна коробка патронов даже если указать макс.количество коробок.

17/04/15
+ Убрано появление навязчивого окошка с предложением указать количество коробок патронов при зарядке оружия перетаскиванием патронов на оружие - если хватает патронов, то оружие заряжается полностью.
* Теперь клавиша перезарядки (ReloadWeaponKey) кроме собственно перезарядки оружия дополнительно функционирует как "Использовать" для не оружия.
+ Изменено минимальное и максимальное значение при выборе возраста игрока с 16-35 на 8-60.
* Добавлено отключение повышения скиллов под эффектами наркотиков когда DrugExploitFix=1.

14/04/15
! Исправлено два бага при использовании инвентаря игрока, что позволяет теперь заряжать оружие помимо способа "взять оружие в руку, а затем перетащить патроны из инвентаря в руку с оружием" способом "перетащить патроны из инвентаря в оружие в инвентаре".
! Исправлен баг влияющий на зарядку оружия способом "перетащить патроны из инвентаря в оружие в инвентаре" если используется High Resolution Patch и переменная IFACE_BAR_MODE из f2_res.ini равна 1 (сбивается порядковый номер слота куда перетаскивается предмет).

08/04/15
! Исправлен "Too Many Items Bug" - "если неожиданно становится невозможно зайти на какую-либо карту из-за того, что игра виснет на черном экране" (c).

05/04/15
+ Добавлена переменная StackEmptyWeapons для складывания вместе одинакового оружия без патронов - решает проблему двух стаков оружия после разрядки одинакового оружия, но с разными патронами.
+ Добавлена переменная RiflescopePenalty для изменения дистанции штрафа для перка 'Оптический прицел', который есть у Охотничьего ружья с опт.прицелом.

03/04/15
* Изменён цвет текста с белого на зелёный для отображение свободного веса (FreeWeight=1).
! В архив добавлен отладочный вариант dll.

01/04/15
* Доработано отображение свободного веса в окне обмена когда FreeWeight=1. Теперь свободный вес показывается и при обмене с контейнерами (ящики/багажник/etc) и во время воровства или торговли (свободный вес не показывается для торгаша, посколько ему можно продавать вещи даже загоняя в минус по весу). Формат - "свободный вес/максимальный вес" для персонажей и "свободный объём/максимальный объём" для контейнеров. Значение FreeWeight игнорируется (равно 0) если переменная CritterInvSizeLimitMode не равна 0.
* В пипбое, когда UseScrollingQuestsList=1, при просмотре списка квестов если больше одной страницы, то наверху показывается номер страницы ("1 из 2") аналогично как при просмотре многостраничных голодисков.

24/03/15
* Убрано оригинальное ограничение на максимальное количество квестов (10) на странице когда UseScrollingQuestsList=1 - теперь сколько на экране пипбоя помещается, столько и показывается.

22/03/15
+ Добавлены переменные QuestsScrollButtonsX (0-618) и QuestsScrollButtonsY (0-434) для возможности изменения положения кнопок прокрутки квестов.

19/03/15
! Для компиляции использованы исходники v3.6.7.346 оригинального sfall для Fallout 2. Это релизный вариант dll, но в нём оставлены SkipSizeCheck и ExtraCRC из секции [Debugging].
- Удалена переменная ReloadWeaponHotKey, поскольку в оригинальный sfall добавлен аналог - ReloadWeaponKey.

17/03/15
+ Почти полностью переработан и расширен функционал кнопок прокрутки квестов (включается переменной UseScrollingQuestsList=1) в пипбое: больше размер, новая позиция, неактивность кнопок когда нечего прокручивать, навигация такая же как при просмотре голодисков, также кнопки теперь можно использовать и при просмотре голодисков.
+ Добавлены "горячие" клавиши для кнопок управления пипбоя - '1' для "Статус", '3' для "Карты", '4' для "Архивы" и '2' для будильника.
! Исправлено два бага кликабельности в пипбое.
* Окно выбора перков на экране персонажа поднято выше.
* Добавлено отключение получения перков под эффектами наркотиков когда DrugExploitFix=1.

08/03/15
+ Добавлена переменная DrugExploitFix для отключения абуза отрицательных эффектов (от наркотиков/радиации/etc) при чтении книг.
* Доработана обработка "пропадания" неиспользованного перка при получении следующего перкового уровня.

28/02/15
+ Добавлена возможность использования русского языка при вводе имени игрока и описания к сохраняемой игре. Разные локализации используют разные кодировки (Fargus/LevCorp - 866, 1C -1251), а потому нужно выбрать подходящую с помощью переменной XltTable. В игре переключение на русский язык осуществляется клавишей которая задана в переменной XltKey (по умолчанию Scroll Lock).
* При включённой переменной FreeWeight изменяется цвет текста на красный при перегрузке.

24/02/15
* Теперь значением переменной ReloadWeaponHotKey является сканкод для указания "горячей" клавиши, а сама переменная перенесена из секции [Misc] в секцию [Input].

19/02/15
+ Добавлена переменная ArmorFile для реализации движкового "NPC armor" мода. Отличие от скриптового варианта заключается в дополнительном изменении внешнего вида сопартийца ещё и на картинке в окне настроек сопартийца.
+ В окне настроек сопартийца в поле "ОД" в скобках показывается его класс брони.
+ Неиспользованный перк теперь не "пропадает" после получения следующего перкового уровня (можно копить перки).

14/02/15
+ Добавлена переменная EquipArmor для автоматического одевания сопартийцем лучшей брони из имеющихся в его инвентаре после закрытия окна обмена.
! Исправлен баг с множественным снятием брони сопартийца через диалог, если у него в сумке есть такая же броня.
+ Расширена функциональность кнопок "Лучшее оружие" и "Лучшая броня" в настройках сопартийца - если оружие/броня одеты, то нажатие на кнопку их снимает.

10/02/15
+ Добавлена переменная FreeWeight для отображения свободного веса вместо веса перекладываемых вещей при обмене с сопартийцем.
! Исправлен баг подсчёта веса вещей у цели при обмене/воровстве - не учитывается вес одетой на цели брони и оружия.
+ В окне настроек сопартийца в поле "Здоровье" в скобках показывается его текущий уровень.

07/02/15
* Теперь, если AutoReloadWeapon=1, после окончания боя перезаряжается оружие в обеих руках.

01/02/15
+ Добавлена переменная ReloadWeaponHotKey для включения перезарядки оружия в активной руке по "горячей" клавише (w|W).

31/01/15
* Расширение функциональности [пере]назначения книг в Books.ini: добавлена возможность повышения и других скиллов при чтении книги.
+ Добавлена переменная AutoReloadWeapon для автоматической перезарядки оружия в активной руке после окончания боя.
! Для компиляции использованы исходники v3.5.7.317 оригинального sfall для Fallout 2.
